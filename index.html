<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Personality Test Final</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            padding: 40px;
        }
        .question {
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        .choices button {
            margin: 5px;
            padding: 15px 25px;
            font-size: 1em;
        }
        .result {
            margin-top: 40px;
            font-size: 1.2em;
        }
    </style>
</head>
<body>

    
    <div id="user-info">
        <label for="user-name">ชื่อ:</label>
        <input type="text" id="user-name" placeholder="กรอกชื่อ" /><br><br>
        <label for="user-department">แผนก:</label>
        <input type="text" id="user-department" placeholder="กรอกแผนก" /><br><br>
        <button onclick="startTest()">เริ่มทำแบบทดสอบ</button>
    </div>
    <div id="question-container" style="display:none;">

        <div id="progress"></div>
        <div class="question" id="question-text"></div>
        <div class="choices">
            <button onclick="submitAnswer(1)">1 ไม่เห็นด้วยเลย</button>
            <button onclick="submitAnswer(2)">2 ค่อนข้างจะ ไม่เห็นด้วย</button>
            <button onclick="submitAnswer(3)">3 เฉยๆ - ไม่แน่ใจ</button>
            <button onclick="submitAnswer(4)">4 ค่อนข้างจะ เห็นด้วย</button>
            <button onclick="submitAnswer(5)">5 เห็นด้วยเป็นอย่างยิ่ง</button>
        </div>
    </div>

    <div class="result" id="result" style="display:none;"></div>

    <script>
        const questions = [{"หมายเลขข้อ": 1, "คำถาม": "ฉันไม่ใช่ผู้ที่มักจะวิตกกังวล", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 2, "คำถาม": "ฉันชอบให้มีผู้คนมากมายรอบข้างตัวฉัน", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 3, "คำถาม": "ฉันไม่ชอบเสียเวลาไปกับการคิดเพ้อผัน", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 4, "คำถาม": "ฉันพยายามที่จะสุภาพกับทุกคน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 5, "คำถาม": "ฉันรักษาความสะอาดและมีระเบียบ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 6, "คำถาม": "บางครั้งฉันรู้สึกทุกข์ใจและโกรธเคือง", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 7, "คำถาม": "การเปิดเผยความลับของตัวเองเป็นสิ่งโง่เขลา", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 8, "คำถาม": "ฉันหัวเราะง่าย", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 9, "คำถาม": "เมื่อฉันพบว่าวิธีใดเป็นวิธีการที่ถูกต้องในการทำสิ่งต่างๆ ฉันก็มักจะใช้วิธีนั้นเป็นประจำ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 10, "คำถาม": "ฉันอยากแก้แค้นเจ้าหน้าที่หรือผู้มีอำนาจ", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 11, "คำถาม": "ฉันมีเรื่องโต้เถียงหรือขัดแย้งกับคนในครอบครัวหรือเพื่อนร่วมงานอยู่บ่อยครั้ง", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 12, "คำถาม": "ฉันสามารถบังคับตัวเองให้ทำงานเสร็จตรงเวลาได้", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 13, "คำถาม": "ฉันรู้สึกเครียดบางครั้งฉันรู้สึกเหมือนกำลังจะแตกเป็นเสี่ยงๆ", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 14, "คำถาม": "ฉันไม่คิดว่าตัวเองเป็นคนร่าเริง", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 15, "คำถาม": "ควรหลีกเลี่ยงปัญหาซึ่งหน้ากับผู้อื่นเพราะเขาอาจจะมีประโยชน์ในอนาคต", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 16, "คำถาม": "ฉันมักใช้วิธีการแก้ปัญหาด้วยวิธีที่ฉันพบจากศิลปะหรือในธรรมชาติ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 17, "คำถาม": "บางคนคิดว่าฉันเห็นแก่ตัว มักพูดถึงแต่ตัวเอง", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 18, "คำถาม": "ฉันไม่ใช่คนที่เจ้าระเบียบ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 19, "คำถาม": "ฉันหลีกเลี่ยงสถานการณ์ที่เสี่ยงอันตรายเป็นประจำ", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 20, "คำถาม": "ฉันไม่ค่อยรู้สึกเหงาหรือเศร้า", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 21, "คำถาม": "ฉันรู้สึกสนุกที่ได้พูดคุยกับผู้คน", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 22, "คำถาม": "ฉันเชื่อว่าการปล่อยให้เด็กฟังคนโต้แย้งกันจะมีแต่ทำให้เด็กเกิดความสับสนและเห็นผิด", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 23, "คำถาม": "คุณควรรอเวลาที่เหมาะสมที่จะแก้แค้นผู้อื่น", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 24, "คำถาม": "ฉันชอบการร่วมมือกันทำงานมากกว่าการแข่งขันกันทำงาน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 25, "คำถาม": "ฉันพยายามทำงานทั้งหมดที่ได้รับมอบหมายอย่างซื่อตรง", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 26, "คำถาม": "การเอาคืนควรทำให้เร็วและต้องสาสม", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 27, "คำถาม": "ฉันมักจะรู้สึกเครียดและกระวนกระวายใจ", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 28, "คำถาม": "ฉันชอบเข้าร่วมในการทำกิจกรรมต่างๆ", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 29, "คำถาม": "บทกวีต่างๆ มีผลต่อฉันเพียงเล็กน้อยหรือไม่มีเลย", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 30, "คำถาม": "ฉันค่อนข้างที่จะดูถูกหรือสงสัยในเจตนาของคนอื่น", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 31, "คำถาม": "คุณควรเก็บความลับเรื่องไม่ดีของคุณเอาไว้ เพื่อรักษาชื่อเสียงของคุณ", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 32, "คำถาม": "ฉันทำงานอย่างมีระเบียบ พร้อมทั้งมีเป้าหมายที่ชัดเจน", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 33, "คำถาม": "บางครั้งฉันรู้สึกว่าตัวเองไร้ค่า", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 34, "คำถาม": "ปกติแล้วฉันชอบที่จะทำสิ่งต่างๆ ตามลำพัง", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 35, "คำถาม": "ฉันชอบลองชิมอาหารใหม่ๆ และอาหารต่างชาติ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 36, "คำถาม": "ฉันเชื่อว่าคนส่วนใหญ่จะเอาเปรียบคนอื่นเมื่อมีโอกาส", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 37, "คำถาม": "ฉันมักเสียเวลาไปกับการบังคับให้ตัวเองเริ่มทำงาน", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 38, "คำถาม": "ต้องมั่นใจว่าแผนการของคุณจะสร้างประโยชน์ให้แก่ตัวคุณไม่ใช่ผู้อื่น", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 39, "คำถาม": "ฉันไม่ค่อยรู้สึกกลัวหรือวิตกกังวล", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 40, "คำถาม": "ฉันมักรู้สึกว่าตัวเองมีพลังงานความสามารถ", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 41, "คำถาม": "ฉันไม่ค่อยเห็นถึงอารมณ์หรือความรู้สึกของตนเองที่เกิดขึ้นในสถานการณ์ต่างๆ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 42, "คำถาม": "คนที่ฉันรู้จักส่วนใหญ่ชอบฉัน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 43, "คำถาม": "ฉันทำงานอย่างหนักเพื่อบรรลุเป้าหมาย", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 44, "คำถาม": "ผู้คนมักบอกว่าฉันควบคุมยาก", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 45, "คำถาม": "ฉันมักจะโกรธในสิ่งที่ผู้คนปฎิบัติต่อฉัน", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 46, "คำถาม": "คนส่วนมากมองว่าฉันมีภาวะความเป็นผู้นำ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 47, "คำถาม": "ฉันมักเป็นคนร่าเริงแจ่มใส", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 48, "คำถาม": "ฉันเชื่อว่าเราควรยึดคำสอนทางศาสนาเพื่อใช้ในการตัดสินเรื่องศีลธรรมจรรยา", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 49, "คำถาม": "บางคนคิดว่าฉันเย็นชาและมุ่งแต่ประโยชน์ส่วนตน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 50, "คำถาม": "เมื่อฉันมุ่งมั่นตั้งใจทำอะไรแล้วฉันจะพยายามทำให้สำเร็จ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 51, "คำถาม": "บ่อยครั้งเมื่อเกิดความผิดพลาดฉันรู้สึกท้อแท้และอยากยอมแพ้", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 52, "คำถาม": "ฉันไม่ใช่คนมองโลกในแง่ดีมีความสุข", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 53, "คำถาม": "กิจกรรมกลุ่มมีแน้วโน้มจะน่าเบื่อหากไม่มีฉัน", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 54, "คำถาม": "บางครั้งเมื่อฉันอ่านบทกวีหรือดูงานศิลปะ ฉันรู้สึกได้ถึงอาการขนลุกซู่หรือเกิดความเร่าร้อนในจิตใจ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 55, "คำถาม": "ฉันมักจะเป็นคนหัวแข็งและยึดติดกับทัศนคติของตัวเอง", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 56, "คำถาม": "ฉันไม่ใช่ผู้ที่ผู้อื่นให้ความไว้ใจหรือเชื่อถือเท่าที่ควร", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 57, "คำถาม": "ฉันไม่ค่อยรู้สึกเศร้าหรือหดหู่", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 58, "คำถาม": "ชีวิตของฉันเต็มไปด้วยกิจกรรม", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 59, "คำถาม": "ฉันมีความสนใจในเรื่องการคาดเดาเกี่ยวกับปรากฏการณ์ทางธรรมชาติหรือความรู้สึกของคนน้อยมาก", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 60, "คำถาม": "ฉันคิดว่าฉันเป็นคนพิเศษ เพราะทุกๆ คนมักพูดแบบนั้นเสมอ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 61, "คำถาม": "ฉันมักจะคิดอย่างละเอียดรอบคอบและมีน้ำใจ", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 62, "คำถาม": "ฉันทำงานสำเร็จตามเป้าหมายทุกครั้ง", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 63, "คำถาม": "คนที่มาวุ่นวายกับฉันมักจะเสียใจในภายหลังเสมอ", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 64, "คำถาม": "บ่อยครั้งที่ฉันต้องการให้คนอื่นมาช่วยแก้ปัญหาแทนฉัน", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 65, "คำถาม": "ฉันเป็นคนที่กระตือรือร้นมาก", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 66, "คำถาม": "ฉันมีความสนใจใคร่รู้เกี่ยวกับเรื่องที่ประเทืองปัญญา", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 67, "คำถาม": "ถ้าฉันรู้สึกไม่ชอบใคร ฉันมักแสดงออกให้พวกเขารู้", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 68, "คำถาม": "ฉันชอบทำความรู้จักคุ้นเคยกับบุคคลสำคัญ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 69, "คำถาม": "ฉันไม่สามารถจัดระเบียบสิ่งต่างๆ ได้", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 70, "คำถาม": "บางครั้งฉันก็รู้สึกอับอายจนอยากหลบซ่อน", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 71, "คำถาม": "ฉันอยากทำอะไรตามทางของตัวเองมากกว่าเป็นผู้นำผู้อื่น", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 72, "คำถาม": "ฉันมักรู้สึกสนุกกับทฤษฎีความคิดเชิงนามธรรม", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 73, "คำถาม": "หากจำเป็นฉันยินดีที่จะบงการคนอื่นเพื่อให้ได้สิ่งที่ต้องการ", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 74, "คำถาม": "ฉันมุ่งมั่นที่จะทำให้ทุกสิ่งออกมาดีเลิศ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 75, "คำถาม": "ฉันมักเปรียบเทียบตนเองกับคนมีชื่อเสียงเสมอ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}];
        let currentQuestion = 0;
        const scores = {
            1: 0,
            2: 0,
            3: 0,
            4: 0,
            5: 0,
            6: 0,
            7: 0,
            8: 0
        };

        function showQuestion() {
            if (currentQuestion >= questions.length) {
                showResults();
                return;
            }
            const q = questions[currentQuestion];
            document.getElementById('question-text').innerText = q['คำถาม'];
            document.getElementById('progress').innerText = `ข้อที่ ${currentQuestion + 1} / ${questions.length}`;
        }

        function submitAnswer(value) {
            const q = questions[currentQuestion];
            const category = q['หมวดคะแนน'];
            const polarity = q['บวกหรือลบ'];
            let score = polarity === 'positive' ? value : 6 - value;

            if (!(category in scores)) {
                scores[category] = 0;
            }
            scores[category] += score;
            
            // เก็บคำตอบดิบ
            userAnswers[currentQuestion] = {
                raw: value,
                polarity: polarity,
                score: score
            };

            currentQuestion++;
            showQuestion();
        }

        function showResults() {
            document.getElementById('question-container').style.display = 'none';
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<h2>ผลรวมคะแนนในแต่ละหมวด (ตามหมายเลขหมวด)</h2>';
            
            // เก็บคะแนนรวมแต่ละหมวด
            for (let [key, val] of Object.entries(scores)) {
                resultDiv.innerHTML += `<p><strong>หมวด ${key}:</strong> ${val}</p>`;
            }

            // เตรียมข้อมูลสำหรับส่ง
            const answers = [];
            for (let i = 0; i < 75; i++) {
                answers.push(userAnswers[i] ? userAnswers[i].raw : 0);
            }

            const categoryScores = {};
            for (let i = 1; i <= 8; i++) {
                categoryScores[i.toString()] = scores[i] || 0;
            }

            const data = {
                name: userName,
                department: userDepartment,
                answers: answers,
                categoryScores: categoryScores
            };

            // ส่งข้อมูลด้วย fetch API
            fetch('https://script.google.com/macros/s/AKfycbx89xSaUQS64w6-jLN2rj0dnYhZbBTyQ6ZqpfzgxznWnLHARoPanZxZvLspJToROSPMgw/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'data=' + encodeURIComponent(JSON.stringify(data))
            })
            .then(() => {
                resultDiv.innerHTML += '<p style="color: green;">บันทึกข้อมูลสำเร็จ!</p>';
                alert('บันทึกข้อมูลสำเร็จ!');
                
                const btn = document.createElement("button");
                btn.textContent = "ทำแบบทดสอบใหม่";
                btn.style.marginTop = "20px";
                btn.style.padding = "10px 20px";
                btn.style.fontSize = "1em";
                btn.onclick = resetTest;
                resultDiv.appendChild(btn);
            })
            .catch(error => {
                resultDiv.innerHTML += '<p style="color: red;">เกิดข้อผิดพลาด: ' + error.message + '</p>';
                alert('เกิดข้อผิดพลาดในการบันทึกข้อมูล');
            });
        }

        function resetTest() {
            // เคลียร์ข้อมูล
            currentQuestion = 0;
            userAnswers.length = 0;
            
            // รีเซ็ตคะแนนทุกหมวด
            for (let i = 1; i <= 8; i++) {
                scores[i] = 0;
            }
            
            // รีเซ็ตหน้าจอ
            document.getElementById('result').style.display = 'none';
            document.getElementById('result').innerHTML = '';
            document.getElementById('user-info').style.display = 'block';
            document.getElementById('question-container').style.display = 'none';
            
            // เคลียร์ input fields
            document.getElementById('user-name').value = '';
            document.getElementById('user-department').value = '';
            userName = '';
            userDepartment = '';

            // เลื่อนหน้าจอกลับขึ้นด้านบน
            window.scrollTo(0, 0);
        }

        showQuestion();
    
        const userAnswers = [];
        function startTest() {
            const name = document.getElementById('user-name').value.trim();
            const department = document.getElementById('user-department').value.trim();
            if (!name || !department) {
                alert("กรุณากรอกชื่อและแผนกก่อนเริ่มทำแบบทดสอบ");
                return;
            }
            userName = name;
            userDepartment = department;
            document.getElementById('user-info').style.display = 'none';
            document.getElementById('question-container').style.display = 'block';
            showQuestion();
        }

        let userName = "";
        let userDepartment = "";

        // เพิ่มปุ่มทดสอบการเชื่อมต่อที่หน้าแรก
        document.addEventListener('DOMContentLoaded', function() {
            const userInfoDiv = document.getElementById('user-info');
            // ลบส่วนของปุ่มทดสอบการเชื่อมต่อออก เนื่องจากไม่จำเป็นแล้ว
        });

    </script>

</body>
</html>
