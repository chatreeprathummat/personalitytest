<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบทดสอบบุคลิกภาพ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4e73df;
            --primary-light: #7395f7;
            --primary-dark: #2e59d9;
            --secondary-color: #f8f9fc;
            --text-color: #333;
            --light-gray: #727272;
            --success-color: #1cc88a;
            --danger-color: #e74a3b;
            --warning-color: #f6c23e;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sukhumvit Set', 'Prompt', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-top: 20px;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        input[type="text"]:focus {
            border-color: var(--primary-light);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 58, 75, 0.25);
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 12px 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-block;
            font-weight: 600;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        button.secondary {
            background-color: #6c757d;
        }

        button.secondary:hover {
            background-color: #5a6268;
        }

        .question-container {
            position: relative;
            min-height: 300px;
        }

        .progress-bar-container {
            height: 8px;
            background-color: var(--light-gray);
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
        }

        .question {
            font-size: 1.25rem;
            margin-bottom: 30px;
            font-weight: 500;
            text-align: center;
        }

        .question-number {
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 0.9rem;
            text-align: center;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        @media (min-width: 768px) {
            .choices {
                flex-direction: row;
                justify-content: center;
            }
        }

        .choice-btn {
            flex: 1;
            padding: 15px 10px;
            text-align: center;
            background-color: rgba(124, 124, 124, 0.752);
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .choice-btn:hover {
            background-color: var(--light-gray);
            transform: translateY(-2px);
        }

        .choice-btn.selected {
            background-color: var(--primary-light);
            color: white;
            border-color: var(--primary-color);
        }

        .result {
            padding: 20px;
        }

        .result-category {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: var(--shadow);
        }

        .result-category h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
            text-align: left;
        }

        .result-score {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .action-btns {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .success-message {
            color: var(--success-color);
            text-align: center;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid var(--success-color);
            border-radius: var(--border-radius);
            background-color: rgba(28, 200, 138, 0.1);
        }

        .error-message {
            color: var(--danger-color);
            text-align: center;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid var(--danger-color);
            border-radius: var(--border-radius);
            background-color: rgba(231, 74, 59, 0.1);
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Loading indicator */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive design */
        @media (max-width: 576px) {
            .container {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .question {
                font-size: 1.1rem;
            }

            .choice-btn {
                padding: 12px 8px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>แบบทดสอบบุคลิกภาพ</h1>
            <p>กรุณาตอบคำถามทั้งหมดเพื่อวิเคราะห์บุคลิกภาพของคุณ</p>
        </div>

        <div id="user-info" class="fade-in">
            <div class="form-group">
                <label for="user-name"><i class="fas fa-user"></i> ชื่อ:</label>
                <input type="text" id="user-name" placeholder="กรุณากรอกชื่อของคุณ" />
            </div>
            <div class="form-group">
                <label for="user-department"><i class="fas fa-building"></i> แผนก:</label>
                <input type="text" id="user-department" placeholder="กรุณากรอกแผนกของคุณ" />
            </div>
            <div class="action-btns">
                <button onclick="startTest()"><i class="fas fa-play"></i> เริ่มทำแบบทดสอบ</button>
            </div>
        </div>

        <div id="question-container" class="question-container fade-in" style="display:none;">
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
            </div>
            <div class="question-number" id="question-number">คำถามที่ 1 จาก 75</div>
            <div class="question" id="question-text"></div>
            <div class="choices">
                <button class="choice-btn" onclick="submitAnswer(1)">1<br>ไม่เห็นด้วยเลย</button>
                <button class="choice-btn" onclick="submitAnswer(2)">2<br>ค่อนข้างจะไม่เห็นด้วย</button>
                <button class="choice-btn" onclick="submitAnswer(3)">3<br>เฉยๆ - ไม่แน่ใจ</button>
                <button class="choice-btn" onclick="submitAnswer(4)">4<br>ค่อนข้างจะเห็นด้วย</button>
                <button class="choice-btn" onclick="submitAnswer(5)">5<br>เห็นด้วยเป็นอย่างยิ่ง</button>
            </div>
        </div>

        <div id="result" class="result fade-in" style="display:none;">
            <h2>ผลการทดสอบบุคลิกภาพของคุณ</h2>
            <div id="result-content"></div>
            <div id="submit-status"></div>
            <div class="action-btns">
                <button onclick="resetTest()"><i class="fas fa-redo"></i> ทำแบบทดสอบใหม่</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [{"หมายเลขข้อ": 1, "คำถาม": "ฉันไม่ใช่ผู้ที่มักจะวิตกกังวล", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 2, "คำถาม": "ฉันชอบให้มีผู้คนมากมายรอบข้างตัวฉัน", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 3, "คำถาม": "ฉันไม่ชอบเสียเวลาไปกับการคิดเพ้อผัน", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 4, "คำถาม": "ฉันพยายามที่จะสุภาพกับทุกคน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 5, "คำถาม": "ฉันรักษาความสะอาดและมีระเบียบ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 6, "คำถาม": "บางครั้งฉันรู้สึกทุกข์ใจและโกรธเคือง", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 7, "คำถาม": "การเปิดเผยความลับของตัวเองเป็นสิ่งโง่เขลา", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 8, "คำถาม": "ฉันหัวเราะง่าย", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 9, "คำถาม": "เมื่อฉันพบว่าวิธีใดเป็นวิธีการที่ถูกต้องในการทำสิ่งต่างๆ ฉันก็มักจะใช้วิธีนั้นเป็นประจำ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 10, "คำถาม": "ฉันอยากแก้แค้นเจ้าหน้าที่หรือผู้มีอำนาจ", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 11, "คำถาม": "ฉันมีเรื่องโต้เถียงหรือขัดแย้งกับคนในครอบครัวหรือเพื่อนร่วมงานอยู่บ่อยครั้ง", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 12, "คำถาม": "ฉันสามารถบังคับตัวเองให้ทำงานเสร็จตรงเวลาได้", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 13, "คำถาม": "ฉันรู้สึกเครียดบางครั้งฉันรู้สึกเหมือนกำลังจะแตกเป็นเสี่ยงๆ", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 14, "คำถาม": "ฉันไม่คิดว่าตัวเองเป็นคนร่าเริง", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 15, "คำถาม": "ควรหลีกเลี่ยงปัญหาซึ่งหน้ากับผู้อื่นเพราะเขาอาจจะมีประโยชน์ในอนาคต", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 16, "คำถาม": "ฉันมักใช้วิธีการแก้ปัญหาด้วยวิธีที่ฉันพบจากศิลปะหรือในธรรมชาติ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 17, "คำถาม": "บางคนคิดว่าฉันเห็นแก่ตัว มักพูดถึงแต่ตัวเอง", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 18, "คำถาม": "ฉันไม่ใช่คนที่เจ้าระเบียบ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 19, "คำถาม": "ฉันหลีกเลี่ยงสถานการณ์ที่เสี่ยงอันตรายเป็นประจำ", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 20, "คำถาม": "ฉันไม่ค่อยรู้สึกเหงาหรือเศร้า", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 21, "คำถาม": "ฉันรู้สึกสนุกที่ได้พูดคุยกับผู้คน", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 22, "คำถาม": "ฉันเชื่อว่าการปล่อยให้เด็กฟังคนโต้แย้งกันจะมีแต่ทำให้เด็กเกิดความสับสนและเห็นผิด", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 23, "คำถาม": "คุณควรรอเวลาที่เหมาะสมที่จะแก้แค้นผู้อื่น", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 24, "คำถาม": "ฉันชอบการร่วมมือกันทำงานมากกว่าการแข่งขันกันทำงาน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 25, "คำถาม": "ฉันพยายามทำงานทั้งหมดที่ได้รับมอบหมายอย่างซื่อตรง", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 26, "คำถาม": "การเอาคืนควรทำให้เร็วและต้องสาสม", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 27, "คำถาม": "ฉันมักจะรู้สึกเครียดและกระวนกระวายใจ", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 28, "คำถาม": "ฉันชอบเข้าร่วมในการทำกิจกรรมต่างๆ", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 29, "คำถาม": "บทกวีต่างๆ มีผลต่อฉันเพียงเล็กน้อยหรือไม่มีเลย", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 30, "คำถาม": "ฉันค่อนข้างที่จะดูถูกหรือสงสัยในเจตนาของคนอื่น", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 31, "คำถาม": "คุณควรเก็บความลับเรื่องไม่ดีของคุณเอาไว้ เพื่อรักษาชื่อเสียงของคุณ", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 32, "คำถาม": "ฉันทำงานอย่างมีระเบียบ พร้อมทั้งมีเป้าหมายที่ชัดเจน", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 33, "คำถาม": "บางครั้งฉันรู้สึกว่าตัวเองไร้ค่า", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 34, "คำถาม": "ปกติแล้วฉันชอบที่จะทำสิ่งต่างๆ ตามลำพัง", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 35, "คำถาม": "ฉันชอบลองชิมอาหารใหม่ๆ และอาหารต่างชาติ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 36, "คำถาม": "ฉันเชื่อว่าคนส่วนใหญ่จะเอาเปรียบคนอื่นเมื่อมีโอกาส", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 37, "คำถาม": "ฉันมักเสียเวลาไปกับการบังคับให้ตัวเองเริ่มทำงาน", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 38, "คำถาม": "ต้องมั่นใจว่าแผนการของคุณจะสร้างประโยชน์ให้แก่ตัวคุณไม่ใช่ผู้อื่น", "หมวดคะแนน": 6, "ชื่อหมวดบุคลิกภาพ": "Machiavellianism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 39, "คำถาม": "ฉันไม่ค่อยรู้สึกกลัวหรือวิตกกังวล", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 40, "คำถาม": "ฉันมักรู้สึกว่าตัวเองมีพลังงานความสามารถ", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 41, "คำถาม": "ฉันไม่ค่อยเห็นถึงอารมณ์หรือความรู้สึกของตนเองที่เกิดขึ้นในสถานการณ์ต่างๆ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 42, "คำถาม": "คนที่ฉันรู้จักส่วนใหญ่ชอบฉัน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 43, "คำถาม": "ฉันทำงานอย่างหนักเพื่อบรรลุเป้าหมาย", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 44, "คำถาม": "ผู้คนมักบอกว่าฉันควบคุมยาก", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 45, "คำถาม": "ฉันมักจะโกรธในสิ่งที่ผู้คนปฎิบัติต่อฉัน", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 46, "คำถาม": "คนส่วนมากมองว่าฉันมีภาวะความเป็นผู้นำ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 47, "คำถาม": "ฉันมักเป็นคนร่าเริงแจ่มใส", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 48, "คำถาม": "ฉันเชื่อว่าเราควรยึดคำสอนทางศาสนาเพื่อใช้ในการตัดสินเรื่องศีลธรรมจรรยา", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 49, "คำถาม": "บางคนคิดว่าฉันเย็นชาและมุ่งแต่ประโยชน์ส่วนตน", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 50, "คำถาม": "เมื่อฉันมุ่งมั่นตั้งใจทำอะไรแล้วฉันจะพยายามทำให้สำเร็จ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 51, "คำถาม": "บ่อยครั้งเมื่อเกิดความผิดพลาดฉันรู้สึกท้อแท้และอยากยอมแพ้", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 52, "คำถาม": "ฉันไม่ใช่คนมองโลกในแง่ดีมีความสุข", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 53, "คำถาม": "กิจกรรมกลุ่มมีแน้วโน้มจะน่าเบื่อหากไม่มีฉัน", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 54, "คำถาม": "บางครั้งเมื่อฉันอ่านบทกวีหรือดูงานศิลปะ ฉันรู้สึกได้ถึงอาการขนลุกซู่หรือเกิดความเร่าร้อนในจิตใจ", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 55, "คำถาม": "ฉันมักจะเป็นคนหัวแข็งและยึดติดกับทัศนคติของตัวเอง", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 56, "คำถาม": "ฉันไม่ใช่ผู้ที่ผู้อื่นให้ความไว้ใจหรือเชื่อถือเท่าที่ควร", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 57, "คำถาม": "ฉันไม่ค่อยรู้สึกเศร้าหรือหดหู่", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 58, "คำถาม": "ชีวิตของฉันเต็มไปด้วยกิจกรรม", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 59, "คำถาม": "ฉันมีความสนใจในเรื่องการคาดเดาเกี่ยวกับปรากฏการณ์ทางธรรมชาติหรือความรู้สึกของคนน้อยมาก", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 60, "คำถาม": "ฉันคิดว่าฉันเป็นคนพิเศษ เพราะทุกๆ คนมักพูดแบบนั้นเสมอ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 61, "คำถาม": "ฉันมักจะคิดอย่างละเอียดรอบคอบและมีน้ำใจ", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 62, "คำถาม": "ฉันทำงานสำเร็จตามเป้าหมายทุกครั้ง", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 63, "คำถาม": "คนที่มาวุ่นวายกับฉันมักจะเสียใจในภายหลังเสมอ", "หมวดคะแนน": 8, "ชื่อหมวดบุคลิกภาพ": "Psychopathy", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 64, "คำถาม": "บ่อยครั้งที่ฉันต้องการให้คนอื่นมาช่วยแก้ปัญหาแทนฉัน", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 65, "คำถาม": "ฉันเป็นคนที่กระตือรือร้นมาก", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 66, "คำถาม": "ฉันมีความสนใจใคร่รู้เกี่ยวกับเรื่องที่ประเทืองปัญญา", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 67, "คำถาม": "ถ้าฉันรู้สึกไม่ชอบใคร ฉันมักแสดงออกให้พวกเขารู้", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 68, "คำถาม": "ฉันชอบทำความรู้จักคุ้นเคยกับบุคคลสำคัญ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 69, "คำถาม": "ฉันไม่สามารถจัดระเบียบสิ่งต่างๆ ได้", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 70, "คำถาม": "บางครั้งฉันก็รู้สึกอับอายจนอยากหลบซ่อน", "หมวดคะแนน": 1, "ชื่อหมวดบุคลิกภาพ": "neuroticism", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 71, "คำถาม": "ฉันอยากทำอะไรตามทางของตัวเองมากกว่าเป็นผู้นำผู้อื่น", "หมวดคะแนน": 2, "ชื่อหมวดบุคลิกภาพ": "extraversion", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 72, "คำถาม": "ฉันมักรู้สึกสนุกกับทฤษฎีความคิดเชิงนามธรรม", "หมวดคะแนน": 3, "ชื่อหมวดบุคลิกภาพ": "openness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 73, "คำถาม": "หากจำเป็นฉันยินดีที่จะบงการคนอื่นเพื่อให้ได้สิ่งที่ต้องการ", "หมวดคะแนน": 4, "ชื่อหมวดบุคลิกภาพ": "agreeableness", "บวกหรือลบ": "negative"}, {"หมายเลขข้อ": 74, "คำถาม": "ฉันมุ่งมั่นที่จะทำให้ทุกสิ่งออกมาดีเลิศ", "หมวดคะแนน": 5, "ชื่อหมวดบุคลิกภาพ": "conscientiousness", "บวกหรือลบ": "positive"}, {"หมายเลขข้อ": 75, "คำถาม": "ฉันมักเปรียบเทียบตนเองกับคนมีชื่อเสียงเสมอ", "หมวดคะแนน": 7, "ชื่อหมวดบุคลิกภาพ": "Narcissism", "บวกหรือลบ": "positive"}];
        
        let currentQuestion = 0;
        const scores = {
            1: 0, // neuroticism
            2: 0, // extraversion
            3: 0, // openness
            4: 0, // agreeableness
            5: 0, // conscientiousness
            6: 0, // Machiavellianism
            7: 0, // Narcissism
            8: 0  // Psychopathy
        };
        
        const categoryNames = {
            1: "Neuroticism (ความวิตกกังวล)",
            2: "Extraversion (การแสดงออก)",
            3: "Openness (การเปิดรับประสบการณ์)",
            4: "Agreeableness (การเห็นพ้องกับผู้อื่น)",
            5: "Conscientiousness (ความมีจิตสำนึก)",
            6: "Machiavellianism (การเอาเปรียบผู้อื่น)",
            7: "Narcissism (ความหลงตัวเอง)",
            8: "Psychopathy (จิตวิทยาด้านลบ)"
        };

        const userAnswers = [];
        let userName = "";
        let userDepartment = "";

        function showQuestion() {
            if (currentQuestion >= questions.length) {
                showResults();
                return;
            }
            
            const q = questions[currentQuestion];
            document.getElementById('question-text').innerText = q['คำถาม'];
            document.getElementById('question-number').innerText = `คำถามที่ ${currentQuestion + 1} จาก ${questions.length}`;
            
            // อัพเดทแถบความคืบหน้า
            const progressPercent = ((currentQuestion) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progressPercent}%`;
            
            // รีเซ็ตปุ่มตัวเลือก
            const choiceButtons = document.querySelectorAll('.choice-btn');
            choiceButtons.forEach(btn => {
                btn.classList.remove('selected');
            });
        }

        function submitAnswer(value) {
            const q = questions[currentQuestion];
            const category = q['หมวดคะแนน'];
            const polarity = q['บวกหรือลบ'];
            let score = polarity === 'positive' ? value : 6 - value;

            if (!(category in scores)) {
                scores[category] = 0;
            }
            scores[category] += score;
            
            // เก็บคำตอบดิบ
            userAnswers[currentQuestion] = {
                raw: value,
                polarity: polarity,
                score: score
            };

            currentQuestion++;
            showQuestion();
        }

        function showResults() {
            document.getElementById('question-container').style.display = 'none';
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            
            const resultContent = document.getElementById('result-content');
            resultContent.innerHTML = '<p>นี่คือคะแนนในแต่ละหมวดหมู่บุคลิกภาพของคุณ:</p>';
            
            // เตรียมข้อมูลสำหรับแสดงผล
            for (let [key, val] of Object.entries(scores)) {
                const categoryName = categoryNames[key] || `หมวด ${key}`;
                
                // สร้างกล่องแสดงผลแต่ละหมวด
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'result-category';
                
                const catHeader = document.createElement('h3');
                catHeader.innerText = categoryName;
                categoryDiv.appendChild(catHeader);
                
                const scoreSpan = document.createElement('div');
                scoreSpan.className = 'result-score';
                scoreSpan.innerText = val;
                categoryDiv.appendChild(scoreSpan);
                
                resultContent.appendChild(categoryDiv);
            }
            
            // เตรียมข้อมูลสำหรับส่ง
            const answers = [];
            for (let i = 0; i < 75; i++) {
                answers.push(userAnswers[i] ? userAnswers[i].raw : 0);
            }

            const categoryScores = {};
            for (let i = 1; i <= 8; i++) {
                categoryScores[i.toString()] = scores[i] || 0;
            }

            const data = {
                name: userName,
                department: userDepartment,
                answers: answers,
                categoryScores: categoryScores
            };

            // แสดงสถานะกำลังบันทึก
            const submitStatus = document.getElementById('submit-status');
            submitStatus.innerHTML = '<div class="loading"><div class="loading-spinner"></div><span style="margin-left: 10px;">กำลังบันทึกข้อมูล...</span></div>';

            // ส่งข้อมูลด้วย fetch API
            fetch('https://script.google.com/macros/s/AKfycbx89xSaUQS64w6-jLN2rj0dnYhZbBTyQ6ZqpfzgxznWnLHARoPanZxZvLspJToROSPMgw/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'data=' + encodeURIComponent(JSON.stringify(data))
            })
            .then(() => {
                submitStatus.innerHTML = '<div class="success-message"><i class="fas fa-check-circle"></i> บันทึกข้อมูลสำเร็จ!</div>';
            })
            .catch(error => {
                submitStatus.innerHTML = `<div class="error-message"><i class="fas fa-exclamation-circle"></i> เกิดข้อผิดพลาด: ${error.message}</div>`;
            });
        }

        function resetTest() {
            // เคลียร์ข้อมูล
            currentQuestion = 0;
            userAnswers.length = 0;
            
            // รีเซ็ตคะแนนทุกหมวด
            for (let i = 1; i <= 8; i++) {
                scores[i] = 0;
            }
            
            // รีเซ็ตหน้าจอ
            document.getElementById('result').style.display = 'none';
            document.getElementById('result-content').innerHTML = '';
            document.getElementById('submit-status').innerHTML = '';
            document.getElementById('user-info').style.display = 'block';
            document.getElementById('question-container').style.display = 'none';
            
            // เคลียร์ input fields
            document.getElementById('user-name').value = '';
            document.getElementById('user-department').value = '';
            userName = '';
            userDepartment = '';

            // เลื่อนหน้าจอกลับขึ้นด้านบน
            window.scrollTo(0, 0);
        }

        function startTest() {
            const name = document.getElementById('user-name').value.trim();
            const department = document.getElementById('user-department').value.trim();
            
            if (!name || !department) {
                alert("กรุณากรอกชื่อและแผนกก่อนเริ่มทำแบบทดสอบ");
                return;
            }
            
            userName = name;
            userDepartment = department;
            
            document.getElementById('user-info').style.display = 'none';
            document.getElementById('question-container').style.display = 'block';
            
            showQuestion();
        }
        
        // ปรับการแสดงผลของปุ่มตัวเลือกเมื่อกด
        document.querySelectorAll('.choice-btn').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.choice-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                this.classList.add('selected');
            });
        });
    </script>
</body>
</html>